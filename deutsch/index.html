<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="./bs.css">
    <title>Deutsch</title>
</head>

<body>
    <div id="main_container">
        <div v-if="!submitted">
            <textarea class="notsubmitted" v-model="textarea"></textarea>
            <button v-on:click="submit">Submit</button>
        </div>
        <button v-if="submitted" class="toggleall" v-on:click="toggleAll">Toggle All</button>
        <div class="container-fluid">
            <div class="row">
                <div class="col-12">
                    <div class="row">
                        <p class="col-3 word" v-on:click="clicked(index)" v-for="(word,index) in words" v-bind:class="paragraphClass(word)">{{word.context}}</p>
                    </div>
                </div>
            </div>
        </div>
        <div>
                <button v-if="submitted" class="toggleall" v-on:click="toggleAll">Toggle All</button>
            <textarea v-if="submitted" class="submitted" v-model="textarea"></textarea>
        </div>
    </div>
</body>

</html>
<script src="./vue.js"></script>
<script>
    var app = new Vue({
        el: '#main_container',
        data: {
            artikels: ["der ", "die ", "das "],
            hide: false,
            submitted: false,
            textarea: "der Apfel\ndie Kartoffel\ndas Auto\nganz\nlecker",
            words: [],
            longall: false,
        },
        methods: {
            paragraphClass(word) {
                console.log("test")
                return {
                    der: word.artikel == "der" && word.long == true,
                    die: word.artikel == "die" && word.long == true,
                    das: word.artikel == "das" && word.long == true,
                }
            },
            submit() {
                this.submitted = true;
                var words = this.textarea.split("\n")
                this.shuffle(words)
                words.forEach(word => {
                    word = word.replace(/\t/g, ' ')
                    if (this.artikels.includes(word.substring(0, 4))) {
                        var wordO = {
                            hasArtikel: true,
                            artikel: word.substring(0, 3).toLowerCase(),
                            word: word.substring(4),
                            context: word.substring(4),
                            long: false
                        }
                    }
                    else {
                        var wordO = {
                            hasArtikel: false,
                            context: word
                        }
                    }
                    this.words.push(wordO)
                });

            },
            long(i) {
                if (this.words[i].hasArtikel) {
                    this.words[i].context = this.words[i].artikel + " " + this.words[i].word
                    this.words[i].long = true
                }
            },
            short(i) {
                if (this.words[i].hasArtikel) {
                    this.words[i].context = this.words[i].word
                    this.words[i].long = false
                }
            },
            toggleAll() {
                if (this.longall) {
                    for (var i = 0; i < this.words.length; i++) {
                        this.short(i)
                    }
                    this.longall = false;
                }
                else {
                    for (var i = 0; i < this.words.length; i++) {
                        this.long(i)
                    }
                    this.longall = true;
                }
            },
            toggle(i) {
                if (this.words[i].hasArtikel) {
                    if (this.words[i].long) {
                        this.short(i)
                    }
                    else {
                        this.long(i)
                    }
                }
            },
            clicked(i) {
                this.toggle(i)
            },
            shuffle(a) {
                for (let i = a.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [a[i], a[j]] = [a[j], a[i]];
                }
                return a;
            }
        }
    })

</script>
<style>
    /* body * {
        border: 1px solid grey;
    } */

    #main_container {
        display: block;
    }

    textarea.notsubmitted {
        display: block;
        width: 200px;
        height: 300px;
    }

    textarea.submitted {
        display: block;
        margin-top: 5vh;
        width: 15vw;
        height: 20vh;
    }

    /* div.submitted{
        border: 5px solid black;
        display: flex;
        justify-content: center;
    } */

    .word {
        text-align: center;
    }

    p.der {
        font-weight: bold;
        color: blue;
    }

    p.die {
        font-weight: bold;
        color: rgb(255, 0, 255);
    }

    p.das {
        font-weight: bold;
    }

    .toggleall {
        display: block;
        font-size: 1.5em;
        padding: 1.5vh 5vw;
        margin-bottom: 2vh;
    }
</style>